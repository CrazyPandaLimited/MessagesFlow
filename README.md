# Описание

Базовые классы для построения систем, основанных на принципах DataFlow паттерна(см MSDN System.Threading.Tasks.Dataflow)
Глобально концепция состоит из нод(Node), которые соединяются друг с другом посредством NodeConnection и по такому дереву передается Message.

# Message
Message, который проходит путь от первой ноды до последней всегда состоит из 2х частей, это заголовок(MessageHeader) и тело сообщения(IMessageBody).  MessageHeader это заголовочная часть message, которая содержит уникальный идентификатор всего message и набор полей, который не меняется при передаче от ноды к ноде. IMessageBody это тело Message, оно содержит результат работы логики ноды. Каждая нода может менять/дополнять и полностью пересоздавать IMessageBody с другим типом и данными.



# Ноды
Нода это кусок логики, который может менять поступивший Message, передавать его дальше к другой ноде или совершать какие-то действия в зависимости от контента в Message.

Ноды бывают 3х типов:

нода только с выходом - это обычно первая нода в дереве, она имеет только выходы которые соеденены с другими нодами дерева. Реализует интерфейс IOutputNode
нода с входом и выходом - это нода, которая до и после себя имеет соединение с другими нодами. Реализует интерфейсы IInputNode и IOutputNode
нода только с входом - это обычно послендняя нода в дереве, она имеет только вход, подключенный к другой ноде. Реализует интерфейс IInputNode


Нода, реализующая интерфейс IOutputNode отвечает только за передачу Message дальше к другой ноде. Они имеет только какое-то количество выходов(от 1). 

Нода, реализующая интерфейс IInputNode отвечает только за обработку поступившего Message. Она имеет состояние FlowNodeStatus, и если это состояние Failed то нода не принимает сообщений и считается сломанной, пока работоспособность не будет восстановлена функцией Restore().



# Соединения
Нода может быть соеденена с другой нодой только если совпадают типы IMessageBody. При этом нода может принимать один тип IMessageBody, а передавать на каждый выход другой тип IMessageBody.



# Обработка ошибок
Системы, реализующие данный подход должны реализовывать следующее поведение в случае возникновения ошибок:

Если при обработке Message в ноде возникла ошибка и нода после этого может корректно обработать последующие Message то ошибку записываем в заголовок Message и передаем Message дальше по цепочке
Если при обработке Message в ноде возникла ошибка и нода после этого не может корректно обработать последующие Message то ошибку необходимо записать в Exception поле ноды, поменять статус ноды на Failed и Message дальше по цепочки не передавать